Sub Stock()    '  Variable declarations    Dim ws As Worksheet    Dim currStock As String    Dim nextStock As String    Dim volume As Double    volume = 0    Dim openPrice As Double    Dim closePrice As Double    Dim yearlyChange As Double    Dim percentChange As Double        For Each ws In Worksheets            ws.Range("I1").Value = "Ticker"    ws.Range("J1").Value = "Yearly Change"    ws.Range("K1").Value = "Percent Change"    ws.Range("L1").Value = "Total Stock Volumn"        ' Keep track of the location for each stock in the summary table    Dim sumTableRow As Integer    sumTableRow = 2        lastRow = Cells(Rows.Count, 1).End(xlUp).Row         openPrice = ws.Cells(2, 3).Value        ' Loop through all stocks in this workbook    For i = 2 To lastRow        'start with vloumn = 0               currStock = Cells(i, 1).Value            nextStock = Cells(i + 1, 1).Value            volume = volume + Cells(i, 7).Value                        ' if next  stock is different            If currStock <> nextStock Then                ' write to summary table                ws.Cells(sumTableRow, 9).Value = currStock                ws.Cells(sumTableRow, 12).Value = volume                closePrice = ws.Cells(i, 6).Value                    ' Yearly Change    yearlyChange = closePrice - openPrice                                                  ' for the error of 0 divider    If openPrice = 0 Then     percentChange = 100 * (yearlyChange / 1E-07)    Else:     percentChange = 100 * (yearlyChange / openPrice)    End If          ' Print the Yearly Change to the Summary Table  ws.Range("J" & sumTableRow).Value = yearlyChange   ' Conditional Color  If yearlyChange > 0 Then  ws.Range("J" & sumTableRow).Interior.ColorIndex = 4  ElseIf yearlyChange < 0 Then  ws.Range("J" & sumTableRow).Interior.ColorIndex = 3  Else  ws.Range("J" & sumTableRow).Interior.ColorIndex = 2  End If   ' Print the Yearly Change to the Summary Table  ws.Range("K" & sumTableRow).Value = percentChange           ' incremet summary table by row'        sumTableRow = sumTableRow + 1        volume = 0        openPrice = ws.Cells(i + 1, 3)                    End If        Next i        'analysis summary report  Dim gtInc_Ticker As String  Dim gtDec_Ticker As String  Dim gtTotal_Ticker As String   Dim gtInc As Double  Dim gtDec As Double  Dim gtTotal As Double  gtInc = 0  gtDec = 0  gtTotal = 0   ws.Range("P1").Value = "Ticker"  ws.Range("Q1").Value = "Value"  ws.Range("O2").Value = "Greatest %Increas"  ws.Range("O3").Value = "Greatest %Decrease"  ws.Range("O4").Value = "Greatest Total Volume"  For i = 2 To sumTableRow - 1  'scan summary report get great value   'find great increase number  If ws.Cells(i, 11).Value > gtInc Then  gtInc = ws.Cells(i, 11).Value  gtInc_Ticker = ws.Cells(i, 9).Value  End If  'find great decrease number  If ws.Cells(i, 11).Value < gtDec Then  gtDec = ws.Cells(i, 11).Value  gtDec_Ticker = ws.Cells(i, 9).Value  End If  'find great volumn  If ws.Cells(i, 12).Value > gtTotal Then  gtTotal = ws.Cells(i, 12).Value  gtTotal_Ticker = ws.Cells(i, 9).Value  End If  Next i   'export result  ws.Range("P2").Value = gtInc_Ticker  ws.Range("P3").Value = gtDec_Ticker  ws.Range("P4").Value = gtTotal_Ticker  ws.Range("Q2").Value = gtInc  ws.Range("Q3").Value = gtDec  ws.Range("Q4").Value = gtTotal        Next ws    End Sub            